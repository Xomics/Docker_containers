FROM rocker/rstudio:4.3.0

# Install system dependencies
RUN apt-get update && apt-get install -y \
    python3-dev \
    python3-pip \
    python3-venv \
    libhdf5-dev \
    libcurl4-openssl-dev \
    libssl-dev \
    libxml2-dev \
    && rm -rf /var/lib/apt/lists/*

# Install Python packages for MOFA2
RUN pip3 install mofapy2

# Install R packages
RUN R -e "install.packages('BiocManager')"
RUN R -e "BiocManager::install(c('MultiAssayExperiment', 'MOFA2'))"

# Configure reticulate to use system Python
RUN R -e "reticulate::use_python('/usr/bin/python3', required = TRUE)"
